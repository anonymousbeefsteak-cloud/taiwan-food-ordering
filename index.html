<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>台灣小吃店 - LINE 快速訂餐</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #f7fafc;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .clickable-btn:active {
            transform: scale(0.95);
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div id="root">
        <div class="min-h-screen flex items-center justify-center p-4">
            <div class="text-center">
                <div class="text-6xl mb-4">⏳</div>
                <p class="text-gray-600">載入訂餐功能中...</p>
            </div>
        </div>
    </div>

    <!-- 載入 React 和相關庫 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // 完整菜單資料
        const menuItems = [
            { name: '滷肉飯', price: 35, icon: '🍚', status: '供應中' },
            { name: '雞肉飯', price: 40, icon: '🍗', status: '供應中' },
            { name: '蚵仔煎', price: 65, icon: '🍳', status: '供應中' },
            { name: '大腸麵線', price: 50, icon: '🍜', status: '供應中' },
            { name: '珍珠奶茶', price: 45, icon: '🥤', status: '供應中' },
            { name: '牛肉麵', price: 120, icon: '🍜', status: '供應中' },
            { name: '臭豆腐', price: 55, icon: '🧆', status: '供應中' },
            { name: '鹽酥雞', price: 60, icon: '🍗', status: '供應中' }
        ];

        // 菜品項目組件
        const MenuItem = ({ item, cartQuantity, onUpdateCart }) => {
            return React.createElement('div', { 
                className: 'bg-white rounded-lg p-4 border border-gray-200 shadow-sm mb-3' 
            },
                React.createElement('div', { className: 'flex justify-between items-start mb-3' },
                    React.createElement('div', null,
                        React.createElement('h3', { className: 'font-bold text-gray-800 text-sm' }, 
                            `${item.icon} ${item.name}`
                        ),
                        React.createElement('p', { className: 'text-green-600 font-bold text-sm' }, 
                            `$${item.price}`
                        )
                    ),
                    React.createElement('span', { 
                        className: 'text-xs px-2 py-1 rounded-full bg-green-100 text-green-800'
                    }, item.status)
                ),
                
                React.createElement('div', { className: 'flex items-center gap-3' },
                    React.createElement('button', {
                        onClick: () => onUpdateCart(item.name, -1),
                        disabled: cartQuantity === 0,
                        className: `w-8 h-8 rounded-full flex items-center justify-center text-white font-bold clickable-btn ${
                            cartQuantity === 0 ? 'bg-gray-400 cursor-not-allowed' : 'bg-red-500 hover:bg-red-600'
                        }`
                    }, '-'),
                    
                    React.createElement('span', { 
                        className: 'min-w-8 text-center font-bold text-lg'
                    }, cartQuantity),
                    
                    React.createElement('button', {
                        onClick: () => onUpdateCart(item.name, 1),
                        className: 'w-8 h-8 rounded-full bg-green-500 text-white font-bold hover:bg-green-600 clickable-btn'
                    }, '+'),
                    
                    React.createElement('span', { 
                        className: 'ml-2 text-xs text-gray-500'
                    }, `小計: $${item.price * cartQuantity}`)
                )
            );
        };

        // 主訂餐組件
        const OrderApp = () => {
            const [cart, setCart] = useState([]);
            const [customerName, setCustomerName] = useState('');
            const [customerPhone, setCustomerPhone] = useState('');
            const [pickupTime, setPickupTime] = useState('');
            const [notes, setNotes] = useState('');

            // 初始化取餐時間
            useEffect(() => {
                const now = new Date();
                now.setMinutes(now.getMinutes() + 30);
                const timeString = now.toTimeString().slice(0, 5);
                setPickupTime(timeString);
            }, []);

            // 更新購物車
            const updateCart = (itemName, change) => {
                setCart(prevCart => {
                    const existingIndex = prevCart.findIndex(item => item.name === itemName);
                    
                    if (existingIndex === -1) {
                        if (change > 0) {
                            const menuItem = menuItems.find(item => item.name === itemName);
                            return menuItem ? [...prevCart, { ...menuItem, quantity: 1 }] : prevCart;
                        }
                        return prevCart;
                    }
                    
                    const newCart = [...prevCart];
                    const currentQuantity = newCart[existingIndex].quantity;
                    const newQuantity = currentQuantity + change;
                    
                    if (newQuantity <= 0) {
                        newCart.splice(existingIndex, 1);
                    } else {
                        newCart[existingIndex] = { ...newCart[existingIndex], quantity: newQuantity };
                    }
                    
                    return newCart;
                });
            };

            // 獲取商品數量
            const getItemQuantity = (itemName) => {
                const item = cart.find(item => item.name === itemName);
                return item ? item.quantity : 0;
            };

            // 清空購物車
            const clearCart = () => {
                if (window.confirm('確定要清空購物車嗎？')) {
                    setCart([]);
                }
            };

            // 計算總金額
            const subtotal = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
            const totalAmount = subtotal;

            // 生成時間選項
            const getTimeOptions = () => {
                const times = [];
                for (let hour = 10; hour <= 21; hour++) {
                    for (let minute = 0; minute < 60; minute += 30) {
                        times.push(`${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`);
                    }
                }
                return times;
            };

            // 提交訂單
            const handleSubmit = () => {
                if (!customerName.trim()) {
                    alert('請填寫姓名');
                    return;
                }
                if (!/^09\d{8}$/.test(customerPhone)) {
                    alert('請輸入有效的10位手機號碼 (09開頭)');
                    return;
                }
                if (cart.length === 0) {
                    alert('請至少選擇一個餐點');
                    return;
                }

                const orderDetails = cart.map(item => 
                    `${item.name} x${item.quantity} = $${item.price * item.quantity}`
                ).join('\n');

                alert(`🎉 訂單提交成功！\n\n👤 顧客姓名: ${customerName}\n📞 聯絡電話: ${customerPhone}\n⏰ 取餐時間: ${pickupTime}\n\n📦 訂單內容:\n${orderDetails}\n\n💰 總金額: $${totalAmount}\n\n📍 取餐地址: 台灣小吃店\n📞 聯絡電話: 02-1234-5678`);
            };

            return React.createElement('div', { className: 'min-h-screen bg-gray-100 p-4' },
                // 主容器
                React.createElement('div', { className: 'container max-w-md mx-auto bg-white rounded-2xl shadow-2xl overflow-hidden' },
                    
                    // 頂部橫幅
                    React.createElement('div', { className: 'bg-[#fff3cd] border border-[#ffeaa7] rounded-t-2xl p-2.5 text-xs text-center text-[#856404]' },
                        '🔒 安全訂餐系統 - 24小時接受預訂'
                    ),

                    // 標頭
                    React.createElement('header', { className: 'bg-green-500 text-white p-5 text-center' },
                        React.createElement('h1', { className: 'text-2xl font-bold mb-1' }, '🍜 台灣小吃店'),
                        React.createElement('p', { className: 'text-sm opacity-90' }, 'LINE 快速訂餐 - 24小時服務')
                    ),

                    // 主內容
                    React.createElement('main', { className: 'p-5 space-y-4' },
                        
                        // 顧客資訊
                        React.createElement('div', { className: 'space-y-4' },
                            React.createElement('div', null,
                                React.createElement('label', { className: 'block mb-2 font-bold text-gray-700 text-sm' }, '姓名 *'),
                                React.createElement('input', {
                                    type: 'text',
                                    value: customerName,
                                    onChange: (e) => setCustomerName(e.target.value),
                                    className: 'w-full p-3 border border-gray-300 rounded-lg text-sm',
                                    placeholder: '請輸入您的姓名'
                                })
                            ),
                            
                            React.createElement('div', null,
                                React.createElement('label', { className: 'block mb-2 font-bold text-gray-700 text-sm' }, '手機號碼 *'),
                                React.createElement('input', {
                                    type: 'tel',
                                    value: customerPhone,
                                    onChange: (e) => setCustomerPhone(e.target.value),
                                    className: 'w-full p-3 border border-gray-300 rounded-lg text-sm',
                                    placeholder: '0936123456'
                                })
                            ),
                            
                            React.createElement('div', null,
                                React.createElement('label', { className: 'block mb-2 font-bold text-gray-700 text-sm' }, '取餐時間 *'),
                                React.createElement('select', {
                                    value: pickupTime,
                                    onChange: (e) => setPickupTime(e.target.value),
                                    className: 'w-full p-3 border border-gray-300 rounded-lg text-sm'
                                },
                                    React.createElement('option', { value: '' }, '請選擇取餐時間'),
                                    getTimeOptions().map(time => 
                                        React.createElement('option', { key: time, value: time }, time)
                                    )
                                )
                            ),
                            
                            React.createElement('div', null,
                                React.createElement('label', { className: 'block mb-2 font-bold text-gray-700 text-sm' }, '備註 (選填)'),
                                React.createElement('textarea', {
                                    value: notes,
                                    onChange: (e) => setNotes(e.target.value),
                                    rows: 2,
                                    className: 'w-full p-3 border border-gray-300 rounded-lg text-sm',
                                    placeholder: '例如：不要香菜、加辣等'
                                })
                            )
                        ),

                        // 菜單區域
                        React.createElement('div', { className: 'bg-gray-50 p-4 rounded-lg border border-gray-200' },
                            React.createElement('h2', { className: 'text-center text-lg font-bold text-gray-800 mb-4' }, '📝 選擇餐點'),
                            React.createElement('div', { className: 'space-y-3' },
                                menuItems.map(item => 
                                    React.createElement(MenuItem, {
                                        key: item.name,
                                        item: item,
                                        cartQuantity: getItemQuantity(item.name),
                                        onUpdateCart: updateCart
                                    })
                                )
                            )
                        ),

                        // 購物車
                        cart.length > 0 && React.createElement('div', { className: 'bg-yellow-50 p-4 rounded-lg border border-yellow-200' },
                            React.createElement('div', { className: 'flex justify-between items-center mb-4' },
                                React.createElement('h2', { className: 'text-lg font-bold text-gray-800' }, 
                                    `🛒 訂單明細 (${cart.reduce((sum, item) => sum + item.quantity, 0)} 項)`
                                ),
                                React.createElement('button', {
                                    onClick: clearCart,
                                    className: 'text-xs bg-red-100 text-red-600 hover:bg-red-500 hover:text-white font-semibold py-1 px-3 rounded-full clickable-btn'
                                }, '🗑️ 清空')
                            ),
                            
                            React.createElement('div', { className: 'space-y-2' },
                                cart.map(item => 
                                    React.createElement('div', { 
                                        key: item.name,
                                        className: 'flex justify-between items-center py-2 border-b border-gray-200'
                                    },
                                        React.createElement('div', null,
                                            React.createElement('p', { className: 'font-bold text-gray-800 text-sm' }, 
                                                `${item.icon} ${item.name}`
                                            ),
                                            React.createElement('p', { className: 'text-xs text-gray-500' }, 
                                                `$${item.price} x ${item.quantity}`
                                            )
                                        ),
                                        React.createElement('p', { className: 'font-bold text-green-600' }, 
                                            `$${item.price * item.quantity}`
                                        )
                                    )
                                )
                            )
                        ),

                        // 金額總結
                        cart.length > 0 && React.createElement('div', { className: 'bg-green-50 p-4 rounded-lg border border-green-200 space-y-2' },
                            React.createElement('div', { className: 'flex justify-between text-sm text-gray-600' },
                                React.createElement('span', null, '餐點總計:'),
                                React.createElement('span', null, `$${subtotal}`)
                            ),
                            React.createElement('div', { className: 'flex justify-between font-bold text-lg text-gray-800 border-t border-gray-300 pt-3 mt-3' },
                                React.createElement('span', null, '總金額:'),
                                React.createElement('span', null, `$${totalAmount}`)
                            )
                        ),

                        // 提交按鈕
                        React.createElement('button', {
                            onClick: handleSubmit,
                            disabled: cart.length === 0,
                            className: `w-full py-3 px-4 rounded-lg text-lg font-bold flex items-center justify-center clickable-btn ${
                                cart.length === 0 
                                    ? 'bg-gray-400 text-gray-200 cursor-not-allowed' 
                                    : 'bg-green-500 hover:bg-green-600 text-white'
                            }`
                        }, cart.length === 0 ? '請選擇餐點' : '✅ 送出訂單')
                    ),

                    // 頁尾
                    React.createElement('footer', { className: 'bg-gray-100 p-4 text-center text-xs text-gray-500 border-t border-gray-200' },
                        React.createElement('p', null, '📍 營業時間: 10:00 - 21:00 | 📞 聯絡電話: 02-1234-5678')
                    )
                )
            );
        };

        // 渲染應用
        console.log('開始渲染完整訂餐應用...');
        ReactDOM.render(React.createElement(OrderApp), document.getElementById('root'));
    </script>
</body>
</html>
